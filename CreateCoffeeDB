-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS PUBLIC."Coffee" ("CoffeeID" integer, "CoffeeProcess" CHARACTER varying, "CoffeeCupScore" real, "FarmID" integer, "OrderID" integer, PRIMARY KEY ("CoffeeID"));


CREATE TABLE IF NOT EXISTS PUBLIC."Supplier" ("SupplierID" integer, "SupplierName" CHARACTER varying, "SupplierCity" CHARACTER varying, "SupplierState" CHARACTER
																																													, PRIMARY KEY ("SupplierID"));


CREATE TABLE IF NOT EXISTS PUBLIC."Farm" ("FarmID" integer, "FarmName" CHARACTER varying, "FarmCity" CHARACTER varying, "FarmCountry" CHARACTER varying, "FarmProvince" CHARACTER varying, "FarmElevation" CHARACTER varying, PRIMARY KEY ("FarmID"));


CREATE TABLE IF NOT EXISTS PUBLIC."Roast" ("RoastID" integer, "RoastDate" timestamp WITH TIME ZONE
																																										, "CoffeeID" integer, "RoasterID" integer, "RoastStats" JSON
																																										, "OperatorID" integer, PRIMARY KEY ("RoastID"));


CREATE TABLE IF NOT EXISTS PUBLIC."Order" ("OrderID" integer, "OrderQTY" integer, "OrderDate" timestamp WITH TIME ZONE
																																										, "OrderShipDate" timestamp WITH TIME ZONE
																																										, "SupplierID" integer, PRIMARY KEY ("OrderID"));


CREATE TABLE IF NOT EXISTS PUBLIC."Varietal" ("VarietalID" integer, "VarietalName" CHARACTER varying, "CoffeeID" integer, PRIMARY KEY ("VarietalID"));

COMMENT ON TABLE PUBLIC."Varietal" IS 'Entity to Represent Varietals and join onto Coffee entity, as a single coffee entity may contain multiple different varietals from a single lot';


CREATE TABLE IF NOT EXISTS PUBLIC."Roaster" ("RoasterID" integer, "RoasterMake" CHARACTER varying, "RoasterModel" CHARACTER varying, "RoasterType" CHARACTER varying, "RoasterCapacityGrams" integer, "RoasterHeating" CHARACTER varying, "RoasterDrumType" CHARACTER varying, PRIMARY KEY ("RoasterID"));


CREATE TABLE IF NOT EXISTS PUBLIC."Operator" ("OperatorID" integer, "OperatorName" CHARACTER varying);


CREATE TABLE IF NOT EXISTS PUBLIC."Cupping" ("CuppingSessionID" integer, "CuppingSessionDate" timestamp WITH TIME ZONE
																																												, "CuppingRoastLevel" CHARACTER varying, "CuppingAromaScore" real, "CuppingFlavorScore" real, "CuppingAftertasteScore" real, "CuppingAcidityScore" real, "CuppingAcidityIntensity" real, "CuppingBodyScore" real, "CuppingBodyLevel" real, "CuppingUniformityScore" integer, "CuppingCleanScore" integer, "CuppingSweetnessScore" integer, "CuppingOverall" real, "CuppingNotes" text, "RoastID" integer, "OperatorID" integer, "CuppingCoffeeWeight_g" real, "CuppingWaterWeight_g" real, "ScaleID" integer, "CuppingWaterTemp_F" real, PRIMARY KEY ("CuppingSessionID"));


CREATE TABLE IF NOT EXISTS PUBLIC."Brew" ("BrewID" integer, "BrewDate" timestamp WITH TIME ZONE
																																									, "BrewDoseWeight" real, "BrewFinalWeight" real, "BrewTime" TIME WITHOUT TIME ZONE
																																									, "BrewLog" JSON
																																									, "RoastID" integer, "OperatorID" integer, "BrewerID" integer, "GrinderID" integer, "ScaleID" integer, "BrewWaterTemp_F" real, PRIMARY KEY ("BrewID"));


CREATE TABLE IF NOT EXISTS PUBLIC."Brewer" ("BrewerID" integer, "BrewerType" CHARACTER varying, "BrewerMake" CHARACTER varying, "BrewerModel" CHARACTER varying, PRIMARY KEY ("BrewerID"));


CREATE TABLE IF NOT EXISTS PUBLIC."Grinder" ("GrinderID" integer, "GrinderMake" CHARACTER varying, "GrinderModel" CHARACTER varying, "GrinderType" CHARACTER varying, "BurrID" integer);


CREATE TABLE IF NOT EXISTS PUBLIC."Burr" ("BurrID" integer, "BurrSize_mm" real, "BurrMaterial" CHARACTER varying, "BurrMake" CHARACTER varying, "BurrModel" CHARACTER varying, PRIMARY KEY ("BurrID"));


CREATE TABLE IF NOT EXISTS PUBLIC."Refractometer" ("RefractometerID" integer, "RefractometerMake" CHARACTER varying, "RefractometerModel" CHARACTER varying, "RefractometerRange" real, "RefractometerPrecision" real, "RefractometerResolution" real, "RefractometerName" CHARACTER varying, PRIMARY KEY ("RefractometerID"));


CREATE TABLE IF NOT EXISTS PUBLIC."Refraction" ("RefractionID" integer, "RefractionTDS" real, "RefractometerID" integer, "SampleID" integer, PRIMARY KEY ("RefractionID"));


CREATE TABLE IF NOT EXISTS PUBLIC."Scale" ("ScaleID" integer, "ScaleMake" CHARACTER varying, "ScaleModel" CHARACTER varying, "ScaleMaxCapacity_g" real, "ScaleMinCapacity_g" real, "ScaleReadability_g" real, "ScaleRepeatability" real, "ScaleName" CHARACTER varying, PRIMARY KEY ("ScaleID"));


ALTER TABLE IF EXISTS PUBLIC."Coffee" ADD
FOREIGN KEY ("FarmID") REFERENCES PUBLIC."Farm" ("FarmID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Coffee" ADD
FOREIGN KEY ("OrderID") REFERENCES PUBLIC."Order" ("OrderID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Coffee" ADD
FOREIGN KEY ("OrderID") REFERENCES PUBLIC."Order" ("OrderID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Roast" ADD
FOREIGN KEY ("CoffeeID") REFERENCES PUBLIC."Coffee" ("CoffeeID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Roast" ADD
FOREIGN KEY ("RoasterID") REFERENCES PUBLIC."Roaster" ("RoasterID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Roast" ADD
FOREIGN KEY ("OperatorID") REFERENCES PUBLIC."Operator" ("OperatorID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Order" ADD
FOREIGN KEY ("SupplierID") REFERENCES PUBLIC."Supplier" ("SupplierID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Varietal" ADD
FOREIGN KEY ("CoffeeID") REFERENCES PUBLIC."Coffee" ("CoffeeID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Cupping" ADD
FOREIGN KEY ("RoastID") REFERENCES PUBLIC."Roast" ("RoastID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Cupping" ADD
FOREIGN KEY ("OperatorID") REFERENCES PUBLIC."Operator" ("OperatorID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Cupping" ADD
FOREIGN KEY ("ScaleID") REFERENCES PUBLIC."Scale" ("ScaleID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Brew" ADD
FOREIGN KEY ("RoastID") REFERENCES PUBLIC."Roast" ("RoastID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Brew" ADD
FOREIGN KEY ("OperatorID") REFERENCES PUBLIC."Operator" ("OperatorID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Brew" ADD
FOREIGN KEY ("BrewerID") REFERENCES PUBLIC."Brewer" ("BrewerID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Brew" ADD
FOREIGN KEY ("GrinderID") REFERENCES PUBLIC."Grinder" ("GrinderID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Brew" ADD
FOREIGN KEY ("ScaleID") REFERENCES PUBLIC."Scale" ("ScaleID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Grinder" ADD
FOREIGN KEY ("BurrID") REFERENCES PUBLIC."Burr" ("BurrID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Refraction" ADD
FOREIGN KEY ("SampleID") REFERENCES PUBLIC."Brew" ("BrewID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Refraction" ADD
FOREIGN KEY ("SampleID") REFERENCES PUBLIC."Cupping" ("CuppingSessionID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;


ALTER TABLE IF EXISTS PUBLIC."Refraction" ADD
FOREIGN KEY ("RefractometerID") REFERENCES PUBLIC."Refractometer" ("RefractometerID") MATCH SIMPLE ON
UPDATE NO ACTION ON
DELETE NO ACTION NOT VALID;

END;